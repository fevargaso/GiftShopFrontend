<div class="amazon-container">
  <div class="admin-header">
    <div class="header-left">
      <div class="controls-container">
        <div class="category-selector">
          <nz-select
            class="filter-select"
            [(ngModel)]="params.category"
            (ngModelChange)="onFilterChange()"
            nzPlaceHolder="All Categories"
            nzAllowClear
          >
            <nz-option *ngFor="let cat of categories" [nzValue]="cat.id" [nzLabel]="cat.name"> </nz-option>
          </nz-select>
        </div>

        <div class="search-wrapper">
          <input
            type="text"
            nz-input
            placeholder="Search products..."
            [(ngModel)]="params.search"
            (ngModelChange)="onSearchChange()"
          />
          <button class="search-confirm-btn" (click)="onFilterChange()">
            <span nz-icon nzType="search"></span>
          </button>
        </div>

        <div class="show-per-page">
          <span class="label">Show:</span>
          <nz-select class="page-size-select" [(ngModel)]="params.pageSize" (ngModelChange)="onFilterChange()">
            <nz-option [nzValue]="6" nzLabel="6 per page"></nz-option>
            <nz-option [nzValue]="10" nzLabel="10 per page"></nz-option>
            <nz-option [nzValue]="20" nzLabel="20 per page"></nz-option>
          </nz-select>
        </div>

        <div class="view-mode-toggle">
          <button nz-button [nzType]="viewMode === 'list' ? 'primary' : 'default'" (click)="toggleViewMode('list')">
            <span nz-icon nzType="unordered-list"></span>
          </button>

          <button nz-button [nzType]="viewMode === 'card' ? 'primary' : 'default'" (click)="toggleViewMode('card')">
            <span nz-icon nzType="appstore"></span>
          </button>
        </div>
      </div>
    </div>
  </div>

  <main class="content-layout">
    <!-- LIST VIEW -->
    <div class="amazon-vertical-list" *ngIf="viewMode === 'list' && products.length">
      <div *ngFor="let product of products" class="amazon-list-item">
        <a class="item-link" [routerLink]="['/products', product.id]">
          <div class="img-wrapper">
            <img [src]="product.imageUrl || 'assets/logo.png'" [alt]="product.name" class="product-img" />
          </div>

          <div class="details-wrapper">
            <div class="text-content">
              <h2 class="item-title">
                {{ product.name || product.description }}
              </h2>

              <div class="stars-row">
                <span class="stars">★★★★☆</span>
                <span class="review-count">245 reviews</span>
              </div>
            </div>

            <div class="price-action-side">
              <div class="price-amazon">
                <span class="symbol">$</span>
                <span class="whole">
                  {{ product.price | number: '1.0-0' }}
                </span>
                <span class="fraction">
                  {{ (product.price % 1) * 100 | number: '2.0-0' }}
                </span>
              </div>

              <app-add-to-cart-button [product]="product"></app-add-to-cart-button>
            </div>
          </div>
        </a>
      </div>
    </div>

    <div class="products-grid" *ngIf="viewMode === 'card' && products.length">
      <app-product-card *ngFor="let product of products" [product]="product"> </app-product-card>
    </div>

    <ng-container *ngIf="!products.length">
      <ng-template [ngTemplateOutlet]="emptyState"></ng-template>
    </ng-container>

    <ng-template #emptyState>
      <div class="no-results">
        <img src="assets/logo.png" alt="No results" class="empty-img" />
        <h3>Can't find what you're looking for?</h3>
        <p>Try checking the spelling or using more general terms.</p>
      </div>
    </ng-template>

    <footer class="pagination-footer" *ngIf="totalItems > params.pageSize">
      <nz-pagination
        [(nzPageIndex)]="params.page"
        [nzTotal]="totalItems"
        [nzPageSize]="params.pageSize"
        (nzPageIndexChange)="onPageChange($event)"
      >
      </nz-pagination>
    </footer>
  </main>
</div>
